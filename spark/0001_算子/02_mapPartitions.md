map是把分区内的数据一个一个操作

所以性能不高



mapPartitions是把分区内数据全部拿到之后，再操作，所以性能很高

所以有多少分区，mapPartitions执行多少次





mapRatitions

- 可以以分区为单位进行数据转换操作
- 但是会将整个分区的数据加载到内存中进行引用
- 处理完的数据不会被释放掉，因为存在对象的引用
- 所以在内存较小，数据量较大的场合下，容易出现内存溢出



