## 事务（Transaction）

通常的观念认为，事务只与数据库有关

比如A给B转账，必须（A-100）和（B+100）的操作同时成功或者同时失败才可以，我们把这样的一组操作叫做事务

事务执行之前，需要先开启事务，start transaction

回滚事务，rollback，修改的数据就会恢复到原有的内容（在commit之前）

提交事务，commit，数据库中的数据就会发生真实的修改



事务的四个特性（ACID）

- 原子性（Atomicity）：是指事务是一个不可分割的单位，在这个单位中，所有的操作或者全部成功，或者全部失败。
- 一致性（Consistency）：是指事务执行前后，数据在完整性上仍然保持一致的特性。
- 隔离性（Isolation）：表示在事务执行过程对数据的修改，在事务提交之前对其他事务不可见。隔离本质是为了保证线程安全。
- 持久性（Durability）：表示事务一旦提交，就会在数据库中发生真实的修改。



原子性、一致性、持久性直接使用这些特性进行工作即可。唯独隔离性没有做出具体的实现，而是给了用户四个选项，去选择适合自己的隔离选项，这个选项称之为隔离级别。

不同的用户对于隔离的要求是不同的，

- 两个事务都是读操作，不涉及数据的更新修改，同时进行也不会产生事务之间的影响
- 两个事务都是写操作，都涉及数据更新修改，极大可能会产生事务相互影响的问题
- 一个事务写，一个事务读，可能会发生事务之间相互影响的问题，问题包含：脏读、不可重复读、虚读/幻读，可以不去解决，但是如果解决的话，可以选择提升数据库的隔离级别来防止。数据库的隔离级别常用的是repeatable read，在这个隔离级别之下，数据安全性较好，执行效率较高。比较适中，适用于开发。



























